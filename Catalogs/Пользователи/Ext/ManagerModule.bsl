
Процедура ОбработкаПолученияПредставления(Данные, Представление, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	//колЗадачСегодня = Неопределено;
	//Если ЗначениеЗаполнено(Данные.Ссылка.ИсполнительОбращений) Тогда
	//	колЗадачСегодня = ПолучитьСтатистикуИсполнителя(Данные.Ссылка);
	//КонецЕсли;
	//Представление = Данные.Ссылка.ПолноеИмя + ?(колЗадачСегодня <> Неопределено, (" (" + колЗадачСегодня + ")"), "");
	Представление = Данные.Ссылка.ПолноеИмя + 
	?(ЗначениеЗаполнено(Данные.Ссылка.добавитьВПредставление),
	" (" + Строка(Данные.Ссылка.добавитьВПредставление) + ")", "");
	                                         	
КонецПроцедуры

Функция ПолучитьСтатистикуИсполнителя(Исполнитель)
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	1 КАК шт,
		|	ЗадачаСоздатьПользователяУчетныеДанные.Ссылка.БизнесПроцесс КАК Ссылка,
		|	ЗадачаСоздатьПользователяУчетныеДанные.Ссылка.БизнесПроцесс.Исполнитель КАК Исполнитель
		|ПОМЕСТИТЬ ВТКол
		|ИЗ
		|	Задача.ЗадачаСоздатьПользователя.УчетныеДанные КАК ЗадачаСоздатьПользователяУчетныеДанные
		|ГДЕ
		|	(
		|		ЗадачаСоздатьПользователяУчетныеДанные.Ссылка.Дата >= НАЧАЛОПЕРИОДА(&Дата, ДЕНЬ)
		|		И ЗадачаСоздатьПользователяУчетныеДанные.Ссылка.БизнесПроцесс.Исполнитель = &Исполнитель
		|		И ЗадачаСоздатьПользователяУчетныеДанные.Ссылка.БизнесПроцесс.Исполнитель.ИсполнительОбращений
		|	) ИЛИ (
		|		ЗадачаСоздатьПользователяУчетныеДанные.Ссылка.БизнесПроцесс.РуководительИТ
		|		И НЕ ЗадачаСоздатьПользователяУчетныеДанные.Ссылка.БизнесПроцесс.Завершен
		|		И ЗадачаСоздатьПользователяУчетныеДанные.Ссылка.БизнесПроцесс.Исполнитель = &Исполнитель
		//|		И ЗадачаСоздатьПользователяУчетныеДанные.Ссылка.БизнесПроцесс.Исполнитель.ИсполнительОбращений
		|	)
		|
		|СГРУППИРОВАТЬ ПО
		|	ЗадачаСоздатьПользователяУчетныеДанные.Ссылка.БизнесПроцесс,
		|	ЗадачаСоздатьПользователяУчетныеДанные.Ссылка.БизнесПроцесс.Исполнитель
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	КОЛИЧЕСТВО(ВТКол.шт) КАК сегодняЗадач
		|ИЗ
		|	ВТКол КАК ВТКол
		|
		|СГРУППИРОВАТЬ ПО
		|	ВТКол.Исполнитель";
	
	Запрос.УстановитьПараметр("Дата", ТекущаяДата());
	Запрос.УстановитьПараметр("Исполнитель", Исполнитель);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Если ВыборкаДетальныеЗаписи.Следующий() Тогда
		Возврат ВыборкаДетальныеЗаписи.сегодняЗадач;
	КонецЕсли;
	
	Возврат Неопределено;	
КонецФункции

Процедура ПечатьДоступ(ТабДок, Ссылка) Экспорт
	//{{_КОНСТРУКТОР_ПЕЧАТИ(ПечатьДоступ)
	Макет = Справочники.Пользователи.ПолучитьМакет("ПечатьДоступ");
	Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ
	|	Пользователи.АдресЭлектроннойПочты,
	|	Пользователи.Наименование
	|ИЗ
	|	Справочник.Пользователи КАК Пользователи
	|ГДЕ
	|	Пользователи.Ссылка В (&Ссылка)";
	Запрос.Параметры.Вставить("Ссылка", Ссылка);
	Выборка = Запрос.Выполнить().Выбрать();

	ОбластьЗаголовок = Макет.ПолучитьОбласть("Заголовок");
	Шапка = Макет.ПолучитьОбласть("Шапка");
	ТабДок.Очистить();

	ВставлятьРазделительСтраниц = Ложь;
	Пока Выборка.Следующий() Цикл
		Если ВставлятьРазделительСтраниц Тогда
			ТабДок.ВывестиГоризонтальныйРазделительСтраниц();
		КонецЕсли;

		ТабДок.Вывести(ОбластьЗаголовок);

		Шапка.Параметры.Заполнить(Выборка);
		ТабДок.Вывести(Шапка, Выборка.Уровень());

		ВставлятьРазделительСтраниц = Истина;
	КонецЦикла;
	//}}
КонецПроцедуры
